---
phase: 01-typescript-foundation
type: execute
---

<objective>
Configure TypeScript compiler, tsconfig.json, and build tooling for the Node.js Express server.

Purpose: Establish the foundational TypeScript configuration with strict type checking and ES module support, enabling the conversion of the entire codebase from JavaScript to TypeScript.

Output: Working TypeScript build pipeline with tsconfig.json and updated package.json scripts.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/STACK.md
@.planning/codebase/ARCHITECTURE.md
@server/package.json
@server/src/index.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install TypeScript and tsx dependencies</name>
  <files>server/package.json</files>
  <action>Run `cd server && npm install -D typescript tsx`. Add TypeScript and tsx as devDependencies. tsx is required for running TypeScript directly with ES modules (the project uses "type": "module"). DO NOT use ts-node - it has poor ES module support. tsx is the modern replacement.</action>
  <verify>cd server && npm list typescript tsx shows both packages installed with correct versions</verify>
  <done>typescript and tsx are in devDependencies and install successfully</done>
</task>

<task type="auto">
  <name>Task 2: Create tsconfig.json with strict type checking</name>
  <files>server/tsconfig.json</files>
  <action>Create tsconfig.json with the following configuration:
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ES2022",
    "lib": ["ES2022"],
    "moduleResolution": "bundler",
    "rootDir": "./src",
    "outDir": "./dist",
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "strictBindCallApply": true,
    "strictPropertyInitialization": true,
    "noImplicitThis": true,
    "alwaysStrict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "esModuleInterop": true,
    "resolveJsonModule": true,
    "allowSyntheticDefaultImports": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```
This enforces strict type checking (per PROJECT.md constraint: "Must use strict TypeScript with no any types"). The ES2022 target and module settings align with Node.js 18+ and Express 5.x requirements.</action>
  <verify>cd server && npx tsc --noEmit runs without errors (validates config syntax)</verify>
  <done>tsconfig.json exists with all strict options enabled, passes tsc --noEmit validation</done>
</task>

<task type="auto">
  <name>Task 3: Update package.json scripts for TypeScript workflow</name>
  <files>server/package.json</files>
  <action>Update the scripts section in package.json:
- Change "dev" from `node --watch src/index.js` to `tsx watch src/index.ts` (tsx has built-in watch mode for TypeScript)
- Change "start" from `node src/index.js` to `node dist/index.js` (production uses compiled JS)
- Add "build" script: `tsc` (compiles TypeScript to dist/)
- Add "type-check" script: `tsc --noEmit` (validates types without emitting files)
- Keep db:generate and db:migrate unchanged (Drizzle works with TS)

The dev script must use tsx watch (not tsx --watch) for proper hot-reload with ES modules. Production uses compiled JS from dist/ for better performance.</action>
  <verify>cd server && npm run build compiles without errors and generates dist/ directory; npm run type-check passes</verify>
  <done>All scripts updated, build command generates dist/ directory, type-check validates without errors</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd server && npm install -D typescript tsx` succeeds
- [ ] `server/tsconfig.json` exists with strict type checking enabled
- [ ] `cd server && npx tsc --noEmit` validates configuration
- [ ] `cd server && npm run build` compiles (will be empty since no .ts files yet)
- [ ] `cd server && npm run type-check` passes
</verification>

<success_criteria>

- TypeScript and tsx installed as devDependencies
- tsconfig.json with strict type checking (noImplicitAny, strictNullChecks, etc.)
- package.json scripts updated for TypeScript workflow
- Build and type-check scripts work correctly
</success_criteria>

<output>
After completion, create `.planning/phases/01-typescript-foundation/01-01-SUMMARY.md`:

# Phase 1 Plan 1: TypeScript Compiler Configuration Summary

**Configured TypeScript toolchain with strict type checking and ES module support.**

## Accomplishments

- Installed TypeScript and tsx for modern Node.js TypeScript execution
- Created tsconfig.json with all strict type checking options enabled
- Updated package.json scripts for development (tsx watch) and production (compiled JS)

## Files Created/Modified

- `server/package.json` - Added typescript and tsx devDependencies, updated scripts
- `server/tsconfig.json` - New TypeScript configuration with strict options

## Decisions Made

- Chose tsx over ts-node: Better ES module support, actively maintained, modern tooling
- Strict type checking: Enforced all strict options (noImplicitAny, strictNullChecks, etc.) per project requirements
- ES2022 target: Aligns with Node.js 18+ and Express 5.x requirements

## Issues Encountered

None

## Next Step

Ready for 01-02-PLAN.md - Setup type definitions for dependencies and project structure
</output>
