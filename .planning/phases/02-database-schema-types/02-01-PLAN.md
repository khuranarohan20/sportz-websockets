---
phase: 02-database-schema-types
plan: 01
type: execute
---

<objective>
Convert Drizzle ORM database schema definitions from JavaScript to TypeScript with automatic type inference.

Purpose: Establish type-safe database layer foundation using Drizzle's built-in TypeScript support.
Output: Type-safe schema definitions in `src/db/schema.ts` with exported inferred types.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-database-schema-types/DISCOVERY.md
@.planning/phases/01-typescript-foundation/01-01-SUMMARY.md
@.planning/phases/01-typescript-foundation/01-02-SUMMARY.md
@server/src/db/schema.js
@server/tsconfig.json

**Tech stack available:**
- typescript@5.9.3 (from Phase 1)
- drizzle-orm@0.45.1 (TypeScript-native)
- @types/node@25.2.3 (from Phase 1)

**Established patterns:**
- Custom types go in src/types/ directory (Phase 1)
- Use global augmentation for environment variable types (Phase 1)
- Check if packages include built-in types before installing @types (Phase 1)
- No any types allowed (Phase 1 strict type checking)

**Constraining decisions:**
- Phase 1: Strict type checking enabled - all schemas must be properly typed
- Phase 1: ES2022 target with bundler module resolution
- Phase 1: TypeScript compiler configured for ES modules

**Discovery findings:**
- Drizzle ORM is TypeScript-native with automatic type inference
- Schema definitions require minimal changes for TypeScript conversion
- Use `$inferSelect` and `$inferInsert` for type exports
- Don't create manual type definitions - use Drizzle's inference
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename schema.js to schema.ts and verify compilation</name>
  <files>server/src/db/schema.js, server/src/db/schema.ts</files>
  <action>Rename server/src/db/schema.js to server/src/db/schema.ts. No code changes needed - Drizzle schema definitions are already valid TypeScript. After renaming, run type-check to verify compilation succeeds. Drizzle's pg-core functions (pgTable, pgEnum, integer, text, etc.) already have full TypeScript support.</action>
  <verify>Run `cd server && npm run type-check` - should pass with no errors. Verify server/src/db/schema.ts exists and server/src/db/schema.js no longer exists.</verify>
  <done>File renamed, TypeScript compilation succeeds with no type errors</done>
</task>

<task type="auto">
  <name>Task 2: Export inferred table types for use in application</name>
  <files>server/src/db/schema.ts</files>
  <action>Add type exports to schema.ts after the table definitions. Export inferred types for matches and commentary tables:
- `type Match = typeof matches.$inferSelect` - For select query results
- `type NewMatch = typeof matches.$inferInsert` - For insert operations
- `type Commentary = typeof commentary.$inferSelect` - For select query results
- `type Commentary = typeof commentary.$inferInsert` - For insert operations

These types will be used in Phase 2-02 and Phase 4 (routes conversion). Place exports at end of file after all table definitions.</action>
  <verify>Run `cd server && npm run type-check` - should pass. Inspect schema.ts to confirm type exports are present.</verify>
  <done>Type exports added, compilation succeeds, types are available for import</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd server && npm run type-check` passes with no errors
- [ ] `cd server && npm run build` compiles successfully to dist/
- [ ] schema.ts file exists with type exports
- [ ] No .js version remains in src/db/
</verification>

<success_criteria>

- Database schema converted to TypeScript
- Type inference working for all table definitions
- Exported types available for use in routes and queries
- No TypeScript compilation errors
- Zero functional changes - schemas work identically
</success_criteria>

<output>
After completion, create `.planning/phases/02-database-schema-types/02-01-SUMMARY.md`:

# Phase 2 Plan 1: Schema Conversion Summary

**Converted Drizzle ORM database schemas to TypeScript with automatic type inference.**

## Accomplishments

- Renamed schema.js to schema.ts (zero code changes needed)
- Exported inferred types for matches and commentary tables
- Verified TypeScript compilation succeeds

## Files Created/Modified

- `server/src/db/schema.ts` - Converted from .js, added type exports

## Decisions Made

[Document any decisions made during execution]

## Issues Encountered

[Document any problems and resolutions, or "None"]

## Next Step

Ready for 02-02-PLAN.md (Type database queries and ORM operations)
</output>
